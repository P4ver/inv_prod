import{u as f,a as N,r as c,l as x,j as e,m as v,S as h,n as w}from"./index-B2YoZsyB.js";const U=()=>{const s=f(),{allUsers:d,status:m,error:p}=N(t=>t.auth),[u,i]=c.useState(null),[l,r]=c.useState({username:"",email:"",role:""});c.useEffect(()=>{s(x())},[s]);const g=async t=>{if((await h.fire({title:"Are you sure?",text:"This user will be deleted!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await s(w(t)).unwrap(),h.fire("Deleted!","User has been deleted.","success"),s(x())}catch(n){h.fire("Error!","There was a problem deleting the user.","error"),console.error("Deletion error:",n)}},j=t=>{i(t.id),r({username:t.username,email:t.email,role:t.role})},y=()=>{i(null),r({username:"",email:"",role:""})},o=t=>{r(a=>({...a,[t.target.name]:t.target.value}))},b=async(t,a)=>{t.preventDefault();try{await s(v({id:a,updatedData:l})).unwrap(),console.log("fromdata user:",l),i(null),r({username:"",email:"",role:""}),s(x())}catch(n){console.error("Update error:",n)}};return e.jsx("div",{className:"overflow-x-auto shadow-lg rounded-xl border border-gray-200 mt-6 bg-white",children:e.jsxs("table",{className:"min-w-full table-fixed divide-y divide-gray-200 text-sm text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left font-semibold w-40 h-8",children:"Username"}),e.jsx("th",{className:"px-4 py-2 text-left font-semibold w-60 h-8",children:"Email"}),e.jsx("th",{className:"px-4 py-2 text-left font-semibold w-50 h-8",children:"Role"}),e.jsx("th",{className:"px-4 py-2 text-left font-semibold w-40 h-8",children:"Active"}),e.jsx("th",{className:"px-4 py-2 text-left font-semibold h-8",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[m==="loading"&&e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-4 py-4 text-center",children:"Loading users..."})}),m==="failed"&&e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-4 py-4 text-center text-red-500",children:p})}),d&&d.length>0?d.map(t=>e.jsx("tr",{className:"hover:bg-gray-50 transition",children:u===t.id?e.jsx("td",{colSpan:5,className:"p-2 bg-gray-50 ",children:e.jsxs("form",{onSubmit:a=>b(a,t.id),className:"flex space-x-1",children:[e.jsx("input",{name:"username",value:l.username,onChange:o,placeholder:"Username",className:"border border-gray-300 px-2 rounded-lg w-40 h-8"}),e.jsx("input",{name:"email",value:l.email,onChange:o,placeholder:"Email",className:"border border-gray-300 px-2 rounded-lg w-60 h-8"}),e.jsxs("select",{name:"role",value:l.role,onChange:o,className:"border border-gray-300 px-2 rounded-lg w-50 h-8",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"technicien",children:"technicien"}),e.jsx("option",{value:"admin",children:"Admin"})]}),e.jsxs("select",{name:"isActive",value:l.isActive?"true":"false",onChange:a=>r(n=>({...n,isActive:a.target.value==="true"})),className:"border border-gray-300 px-2 rounded-lg w-40 h-8",children:[e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]}),e.jsx("button",{type:"submit",className:"px-2 bg-green-600 text-white rounded-lg",children:"Save"}),e.jsx("button",{type:"button",onClick:y,className:"px-2 bg-gray-300 text-gray-700 rounded-lg",children:"Cancel"})]})}):e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-4 py-2",children:t.username}),e.jsx("td",{className:"px-4 py-2",children:t.email}),e.jsx("td",{className:"px-4 py-2 capitalize",children:t.role}),e.jsx("td",{className:"px-4 py-2",children:t.isActive?e.jsx("span",{className:"text-green-600 font-medium",children:"Yes"}):e.jsx("span",{className:"text-red-500 font-medium",children:"No"})}),e.jsxs("td",{className:"px-4 py-2 space-x-2",children:[e.jsx("button",{className:"px-3 py-1 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600",onClick:()=>j(t),children:"Edit"}),e.jsx("button",{className:"px-3 py-1 bg-red-500 text-white rounded-lg hover:bg-red-600",onClick:()=>g(t.id),children:"Delete"})]})]})},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-4 py-4 text-center",children:"No users found."})})]})]})})};export{U as default};
