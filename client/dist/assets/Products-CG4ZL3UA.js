import{u as q,a as y,r as l,f as b,g as f,j as e,S as d,h as A,i as D,k as E}from"./index-B2YoZsyB.js";const R=()=>{const o=q(),{products:j}=y(a=>a.products),{categories:p}=y(a=>a.categories),[C,g]=l.useState(null),[M,x]=l.useState(!1),[L,N]=l.useState(!1),[i,v]=l.useState(""),[h,w]=l.useState(""),[k,c]=l.useState(!1),[r,u]=l.useState({marking_code:"",code:"",description:"",package_type:"",quantity:"",CategoryId:""});l.useEffect(()=>{o(b()),o(f())},[o]);const n=a=>{u(t=>({...t,[a.target.name]:a.target.value}))},m=async(a,t)=>{a.preventDefault(),x(!0);try{const s={...r,CategoryId:parseInt(r.CategoryId,10)||null};t?(await o(D({id:t,updatedData:s})).unwrap(),d.fire({icon:"success",title:"Updated!",text:"Product updated successfully."})):(await o(E(s)).unwrap(),d.fire({icon:"success",title:"Created!",text:"Product created successfully."}),N(!1),c(!1)),g(null),o(b()),u({marking_code:"",code:"",description:"",quantity:"",package_type:"",CategoryId:""})}catch(s){console.error("Error:",s),d.fire({icon:"error",title:"Oops...",text:(s==null?void 0:s.message)||"An error occurred while saving the product."})}finally{x(!1)}},S=a=>{g(a.id),u({marking_code:a.marking_code,code:a.code,description:a.description,package_type:a.package_type,quantity:a.quantity,CategoryId:a.CategoryId})},_=()=>{g(null),u({marking_code:"",code:"",description:"",quantity:"",package_type:"",CategoryId:""})},I=j.filter(a=>{if(!i)return!0;if(h){const t=a[h];return t&&t.toString().toLowerCase().includes(i.toLowerCase())}return Object.values(a).some(t=>t==null?void 0:t.toString().toLowerCase().includes(i.toLowerCase()))}),P=async()=>{const{value:a}=await d.fire({title:"Add New Category",input:"text",inputLabel:"Category Name",inputPlaceholder:"Enter category name",showCancelButton:!0,confirmButtonText:"Add",preConfirm:t=>(t.trim()||d.showValidationMessage("Category name is required"),t.trim())});if(a)try{await o(A({name:a})).unwrap(),await o(f()),d.fire("Success","Category added successfully!","success")}catch(t){d.fire("Error",t.message||"Failed to add category","error")}};return e.jsxs("div",{className:"overflow-x-auto shadow-lg rounded-xl border border-gray-200 mt-6 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",placeholder:"Search products...",value:i,onChange:a=>v(a.target.value),className:"border border-gray-300 p-1 rounded-lg focus:outline-none focus:border-blue-400"}),e.jsxs("select",{value:h,onChange:a=>w(a.target.value),className:"border border-gray-300 p-1 rounded-lg focus:outline-none focus:border-blue-400",children:[e.jsx("option",{value:"",children:"Search All"}),e.jsx("option",{value:"marking_code",children:"Marking Code"}),e.jsx("option",{value:"code",children:"Ref"}),e.jsx("option",{value:"description",children:"Description"}),e.jsx("option",{value:"package_type",children:"Package Type"}),e.jsx("option",{value:"quantity",children:"Quantity"}),e.jsx("option",{value:"CategoryId",children:"Category"})]}),e.jsxs("div",{className:"flex justify-end p-4",children:[e.jsx("button",{onClick:()=>{c(!0)},className:"bg-blue-600 text-white px-4 py-1 rounded-lg hover:bg-blue-700 transition",children:"Add Product"}),e.jsx("button",{onClick:P,className:"bg-green-600 text-white px-3 py-1 mx-2 rounded-lg hover:bg-green-700 transition",children:"Add Category"})]})]}),e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left font-semibold w-32 h-8",children:"Marking Code"}),e.jsx("th",{className:"px-4 py-2 text-left font-semibold w-32 h-8",children:"Ref"}),e.jsx("th",{className:"px-4 py-2 text-left font-semibold w-60 h-8",children:"Description"}),e.jsx("th",{className:"px-4 py-2 text-left font-semibold w-30 h-8",children:"Package Type"}),e.jsx("th",{className:"px-4 py-2 text-left font-semibold w-14 h-8",children:"Quantity"}),e.jsx("th",{className:"px-4 py-2 text-left font-semibold w-28 h-8",children:"Category"}),e.jsx("th",{className:"px-4 py-2 text-left font-semibold",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:I.map(a=>{var t;return e.jsx("tr",{className:"hover:bg-gray-50 transition",children:C===a.id?e.jsx("td",{colSpan:7,className:"p-2 bg-gray-50 rounded-lg",children:e.jsxs("form",{onSubmit:s=>m(s,a.id),className:"flex space-x-2",children:[e.jsx("input",{name:"marking_code",value:r.marking_code,onChange:n,className:"border border-gray-300 px-2 rounded-lg focus:outline-none focus:border-blue-400 w-30 h-8",placeholder:"Marking Code"}),e.jsx("input",{name:"code",value:r.code,onChange:n,className:"border border-gray-300 p-2 rounded-lg focus:outline-none focus:border-blue-400 w-30 h-8",placeholder:"Ref"}),e.jsx("input",{name:"description",value:r.description,onChange:n,className:"border border-gray-300 p-2 rounded-lg focus:outline-none focus:border-blue-400 w-60 h-8",placeholder:"Description"}),e.jsx("input",{name:"package_type",value:r.package_type,onChange:n,className:"border border-gray-300 p-2 rounded-lg focus:outline-none focus:border-blue-400 w-26 h-8",placeholder:"Package Type"}),e.jsx("input",{name:"quantity",type:"number",value:r.quantity,onChange:n,className:"border border-gray-300 p-1.5 mr-6 rounded-lg focus:outline-none focus:border-blue-400 w-14 h-8",placeholder:"Quantity"}),e.jsxs("select",{name:"CategoryId",value:r.CategoryId,onChange:n,className:"border border-gray-300 px-1.5 rounded-lg focus:outline-none focus:border-blue-400 w-30 h-8",children:[e.jsx("option",{value:"",children:"Select"}),p.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("button",{type:"submit",className:"px-2  bg-green-600 text-white rounded-lg",children:"Save"}),e.jsx("button",{type:"button",onClick:_,className:"px-2 bg-gray-300 text-gray-700 rounded-lg",children:"Cancel"})]})}):e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-4 py-2",children:a.marking_code}),e.jsx("td",{className:"px-4 py-2",children:a.code}),e.jsx("td",{className:"px-4 py-2",children:a.description}),e.jsx("td",{className:"px-4 py-2",children:a.package_type}),e.jsx("td",{className:"px-4 py-2",children:a.quantity}),e.jsx("td",{className:"px-4 py-2",children:((t=p.find(s=>s.id===a.CategoryId))==null?void 0:t.name)||"â€”"}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("button",{onClick:()=>S(a),className:"px-3 py-1 bg-yellow-500 text-white rounded-lg",children:"Edit"})})]})},a.id)})})]}),k&&e.jsxs("div",{className:"fixed inset-0 flex justify-center items-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-40",onClick:()=>c(!1)}),e.jsxs("div",{className:"relative z-50 bg-white p-6 rounded-xl shadow-lg w-[90%] max-w-3xl",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-800",children:"Add New Product"}),e.jsxs("form",{onSubmit:a=>m(a),className:"grid grid-cols-2 gap-4",children:[e.jsx("input",{name:"marking_code",value:r.marking_code,onChange:n,placeholder:"Marking Code",className:"border px-2 py-1 rounded-lg"}),e.jsx("input",{name:"code",value:r.code,onChange:n,placeholder:"Ref",className:"border px-2 py-1 rounded-lg"}),e.jsx("input",{name:"description",value:r.description,onChange:n,placeholder:"Description",className:"border px-2 py-1 rounded-lg col-span-2"}),e.jsx("input",{name:"package_type",value:r.package_type,onChange:n,placeholder:"Package Type",className:"border px-2 py-1 rounded-lg"}),e.jsx("input",{name:"quantity",type:"number",value:r.quantity,onChange:n,placeholder:"Quantity",className:"border px-2 py-1 rounded-lg"}),e.jsxs("select",{name:"CategoryId",value:r.CategoryId,onChange:n,className:"border px-2 py-1 rounded-lg",children:[e.jsx("option",{value:"",children:"Select Category"}),p.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsxs("div",{className:"col-span-2 flex justify-end space-x-3 mt-4",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Add Product"})]})]})]})]})]})};export{R as default};
